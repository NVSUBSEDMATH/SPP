---
title: "stock price forecasting"
author: "rizza pudao"
format: html
editor: visual
---

```{r}
library(forecast)
library(ggplot2)
library(readr)
library(zoo)
```

# Background

## Stock Price 

The term stock price refers to the current price that a share of stock is trading for on the market. Every publicly-traded company, when its shares are issued, is given a price an assignment of their value that ideally reflects the value of the company itself. The price of a stock will go up and down in relation to a number of different factors, including changes within the economy as a whole, changes within industries, political events, war, and environmental changes. Stock prices change everyday by market forces. By this we mean that share prices change because of supply and demand. If more people want to buy a stock demand than sell it supply, then the price moves up.

Aside from the other things that make any stock price change, there can be issues within a company that cause its stock price to move in either direction.

#### **1. Law of supply and demand**

If a company produces a good that not many others produce or a good that is highly desired or necessary, the price of its stock will climb because the demand is high. When the supply of the good balances out with the demand, stock prices will tend to plateau. If the supply is greater than the demand, the company\'s share price will likely drop.

It also depends on how effectively and uniquely the company produces the good. If they create a variation on an old standard, their share price may stay the same or increase even if supply is high.

#### **2. Management or production changes**

Changes in management or production can also cause a company\'s share price to rise or fall. It depends on how effectively and efficiently the company is managed and goods are produced. Changes to the management team, style, or how goods are produced can boost efficiency and thus overall effectiveness -- increasing profits and causing the share price to rise. However, negative changes can result in the exact opposite effect.

#### **3. Mention of the company\'s name**

One other point of note that can significantly affect the stock price is the mention of the company\'s name in the news, on social media or by word of mouth.

### **Stock Price Changes includes the following Company** 

### 
1. Megawide Construction Corporation (MWIDE)

Megawide Construction Corporation is engaged in the general construction business. The Company's business includes constructing, enlarging, repairing, or engaging in any work upon buildings, houses and condominium, roads, plants, bridges, piers, waterworks, railroads and other structures, and to own, use and develop real estate of various kinds. Its segments are Construction and Airport Operations. The Construction segment is engaged in the general construction business, which involves site development, earthworks, structural and civil works, masonry works, and architectural finishes, electrical works, plumbing and sanitary works, fire protection works and mechanical works. The Airport Operations segment is engaged in the business of building, rehabilitating, renovating, constructing, developing, operating, and maintaining the Mactan Cebu International Airport, including the commercial assets thereof and various allied business for the operation and maintenance of the airport facility.

MWIDE grew its infrastructure segment from 5% to 17% of revenues in 2021, and is looking to grow the segment even further this year. MWIDE\'s focus on this segment is supported by its observation that infrastructure development has remained strong through different \"cycles\" of the economy, and that the Marcos administration appears willing to maintain infrastructure development as a top priority.

#### Graph for Megawide Construction Corp Price (MWIDE)

```{r}
MWIDE <- read_csv("/cloud/project/CSV/MWIDE.csv", col_types = cols(Week = col_date(format = "%Y-%m-%d")))
MWIDE_ts <- ts(MWIDE[,2], freq=365.25/7, start=2015+177/365.25)
MWIDE_ts %>%
  autoplot()
```

```{r}
td_decomp <- decompose(na.locf(MWIDE_ts), type="additive")
autoplot(td_decomp)
```

```{r}
training_MWIDE <- subset(MWIDE_ts, end=length(MWIDE_ts)-8)
test_MWIDE <- subset(MWIDE_ts, start=length(MWIDE_ts)-8)
fc_training_MWIDE<-forecast(training_MWIDE)
fc_training_MWIDE %>%
  forecast(h=10) %>%
  autoplot() +autolayer(test_MWIDE)
```

```{r}
fc_training_MWIDE
```

```{r}
fc_MWIDE<-forecast(MWIDE_ts)
fc_MWIDE %>%
  forecast(h=50) %>%
  autoplot()
```

```{r}
tail(MWIDE_ts)
min(MWIDE_ts)
max(MWIDE_ts)
which.min(MWIDE_ts)
```

```{r}
bestfit_MWIDE_ts <- list(aicc=Inf)
for(i in 1:25)
{
  fit_MWIDE_ts <- auto.arima(MWIDE_ts, xreg=fourier(MWIDE_ts, K=i), seasonal=FALSE)
  if(fit_MWIDE_ts$aicc < bestfit_MWIDE_ts$aicc)
    bestfit_MWIDE_ts <- fit_MWIDE_ts
  else break;
}
```

```{r}
summary(bestfit_MWIDE_ts)
```

### 2.  Nickel Asia Corporation (NIKL) 

Nickel Asia Corporation (NIKL) was incorporated on July 24, 2008 with the Securities and Exchange Commission primarily to engage in the business of mining of all kinds of ore, metals, and minerals and in the business of generation, transmission, distribution and supply of electricity to cities and other localities.\
\
The nickel market has been suffering from low liquidity since earlier this year. On 8 March, nickel prices rose more than 250%, following fears of the disruption of nickel supplies due to the Russian invasion of Ukraine. Russia is the third largest global nickel producer, with over 200,000 tonnes of output in 2021, or 7.5% of global production. The LME then suspended trading after the short squeeze, a controversial decision for which the LME is now being sued in British court. "A lack of risk capital lowers market participation, driving down liquidity and exacerbating volatility, and further discouraging potential lenders and investors, reinforcing lower participation and higher volatility," said Goldman Sachs at the time.

Now, small changes in the physical market can lead to big shifts in trading. Data from the LME already shows that average monthly nickel trading volumes (excluding unallocated trade) have gone down since March. October showed the lowest average so far, with volumes of 32,811. In January, volumes were still up to 83,827. nickel production is forecasted to grow around 3.4% a year to 3,281kt in 2026, according to GlobalData, growing at similar levels to forecasted consumption for 2026. That puts the nickel market in a better position than some other critical minerals, which are expected to experience shortages leading up to 2030.

In the most recent nickel price news, the metal had been on a bull run which began in the final quarter of 2021, As 2022 comes to a close, nickel has emerged as the clear winner among base metals that have survived a volatile year.

#### Graph for NIKL

```{r}
NIKL <- read_csv("/cloud/project/CSV/NIKL.csv", col_types = cols(Week = col_date(format = "%Y-%m-%d")))
NIKL_ts <- ts(NIKL[,2], freq=365.25/7, start=2015+159/365.25)
NIKL_ts %>%
  autoplot()
```

```{r}
td_decomp <- decompose(na.locf(NIKL_ts), type="additive")
autoplot(td_decomp)
```

```{r}
training_NIKL <- subset(NIKL_ts, end=length(NIKL_ts)-8)
test_NIKL <- subset(NIKL_ts, start=length(NIKL_ts)-8)
fc_training_NIKL<-forecast(training_NIKL)
fc_training_NIKL %>%
  forecast(h=10) %>%
  autoplot() +autolayer(test_NIKL)
```

```{r}
fc_training_NIKL
```

```{r}
fc_NIKL<-forecast(NIKL_ts)
fc_NIKL %>%
  forecast(h=50) %>%
  autoplot()
```

```{r}
tail(NIKL_ts)
min(NIKL_ts)
max(NIKL_ts)
which.min(NIKL_ts)
```

```{r}
bestfit_NIKL_ts <- list(aicc=Inf)
for(i in 1:25)
{
  fit_NIKL_ts <- auto.arima(NIKL_ts, xreg=fourier(NIKL_ts, K=i), seasonal=FALSE)
  if(fit_NIKL_ts$aicc < bestfit_NIKL_ts$aicc)
    bestfit_NIKL_ts <- fit_NIKL_ts
  else break;
}
```

```{r}
summary(bestfit_NIKL_ts)
```

### 3. Service Now Corporation (NOW)

Now Corp. engages in the provision of telecommunications, media, and technology products and services. It operates through the following segments: Software Licenses and Services, IT Manpower and Resource Augmentation, and Broadband and Wireless Cable TV Services. The Software Licenses and Services segment offers software and IT-enabled services. The IT Manpower and Resource Augmentation segment focuses in consulting, technical advice, and professional advisory services to persons, firms, association, corporations, partnerships, and other entities. The Broadband and Wireless Cable TV Services segment gives broadband service to the underserved and unserved large enterprises such as schools, hospitals, high-end residential buildings, and commercial buildings with multiple BPO locators. The company was founded on June 5, 1996 and is headquartered in Makati, Philippines.

Shares of ServiceNow (NOW 0.39%) were pulling back last month on a broad sell-off in tech stocks, as a strong first-quarter earnings report wasn't enough to counteract the shifting market sentiment. According to data from S&P Global Market Intelligence, the stock finished the month down 14%. There was little news out on Service Now through the first three weeks of the month, and the stock tracked with the slide in the Nasdaq as investors reacted to news that interest rates could rise faster than expected, with the Federal Reserve seeking to bring inflation to heel and cool off the economy.

Service Now stock actually jumped 8.1% on April 28, after the company delivered a strong first-quarter earnings report. Revenue increased 27% to \$1.72 billion, matching estimates, and remaining performance operations jumped 29% to \$5.69 billion, showing a strong backlog.

Profitability was also impressive, with a 25% operating margin, and adjusted earnings per share jumped from \$0.37 to \$1.73, ahead of estimates at \$1.70. "Service Now delivered another outstanding performance that beat expectations across the board," CEO Bill McDermott said. "We are in a sustained demand environment. Companies are investing with a sense of urgency in technologies that get them to the right outcomes, fast."

#### Graph for NOW

```{r}
NOW <- read_csv("/cloud/project/CSV/NOW.csv", col_types = cols(Week = col_date(format = "%Y-%m-%d")))
NOW_ts <- ts(NOW[,2], freq=365.25/7, start=2015+158/365.25)
NOW_ts %>%
  autoplot()
```

```{r}
td_decomp <- decompose(na.locf(NOW_ts), type="additive")
autoplot(td_decomp)
```

```{r}
training_NOW  <- subset(NOW_ts, end=length(NOW_ts)-8)
test_NOW  <- subset(NOW_ts, start=length(NOW_ts)-8)
fc_training_NOW <-forecast(training_NOW )
fc_training_NOW  %>%
  forecast(h=10) %>%
  autoplot() +autolayer(test_NOW )
```

```{r}
fc_training_NOW 
```

```{r}
fc_NOW <-forecast(NOW_ts)
fc_NOW  %>%
  forecast(h=50) %>%
  autoplot()
```

```{r}
tail(NOW_ts)
min(NOW_ts)
max(NOW_ts)
which.min(NOW_ts)
```

```{r}
bestfit_NOW_ts <- list(aicc=Inf)
for(i in 1:25)
{
  fit_NOW_ts <- auto.arima(NOW_ts, xreg=fourier(NOW_ts, K=i), seasonal=FALSE)
  if(fit_NOW_ts$aicc < bestfit_NOW_ts$aicc)
    bestfit_NOW_ts <- fit_NOW_ts
  else break;
}
```

```{r}
summary(bestfit_NOW_ts)
```

### 4. Ore Corporation Limited

OreCorp Limited is an Australia-based development and exploration company. The Company is focused on its mineral exploration for gold and precious metals. Its lead projects is the Nyanzaga Gold Project in northwest Tanzania. The Nyanzaga Project is a gold development project with considerable drilling and associated mining information consisting of the granted special mining lease (SML), which covers 23.4 km2 (square kilometer) and encompasses the Nyanzaga and Kilimani deposits, and 13 active prospecting licenses and one prospecting license application covering approximately 153 km2. The project is situated approximately 60 kilometers southwest of Mwanza and 35 kilometers northeast of the Bulyanhulu gold mine.

Year on year Orecorp Ltd's revenues fell -26.68% from 206.91k to 151.70k. This along with an increase in selling, general and administrative costs has contributed to a reduction in net income from a loss of 9.24m to a larger loss of 26.85m. On Tuesday, Orecorp Ltd (ORR:ASX) closed at 0.43, 38.71% above the 52 week low of 0.31 set on Nov 08, 2022.

#### Graph for ORE

```{r}
ORE <- read_csv("/cloud/project/CSV/ORE.csv", col_types = cols(Week = col_date(format = "%Y-%m-%d")))
ORE_ts <- ts(ORE[,2], freq=365.25/7, start=2015+247/365.25)
ORE_ts %>%
  autoplot()
```

```{r}
td_decomp <- decompose(na.locf(ORE_ts), type="additive")
autoplot(td_decomp)
```

```{r}
training_ORE <- subset(ORE_ts, end=length(ORE_ts)-8)
test_ORE <- subset(ORE_ts, start=length(ORE_ts)-8)
fc_training_ORE<-forecast(training_ORE)
fc_training_ORE %>%
  forecast(h=10) %>%
  autoplot() +autolayer(test_ORE)
```

```{r}
fc_training_ORE
```

```{r}
fc_ORE<-forecast(ORE_ts)
fc_ORE %>%
  forecast(h=50) %>%
  autoplot()
```

```{r}
tail(ORE_ts)
min(ORE_ts)
max(ORE_ts)
which.min(ORE_ts)
```

```{r}
bestfit_ORE_ts <- list(aicc=Inf)
for(i in 1:25)
{
  fit_ORE_ts <- auto.arima(ORE_ts, xreg=fourier(ORE_ts, K=i), seasonal=FALSE)
  if(fit_ORE_ts$aicc < bestfit_ORE_ts$aicc)
    bestfit_ORE_ts <- fit_ORE_ts
  else break;
}
```

```{r}
summary(bestfit_ORE_ts)
```

# 
