---
title: "SPP"
author: NVSUBSEDMATH
output: html_notebook
---
We are going to get data from 

```{r}
load("~/R/SPP/SPP.RData")
```

# ALLHC

```{r}
allhc <- ts(ALLHC[,2], freq=365.25/7, start=2015+37/365.25)
plot(allhc)
```

```{r}
plot(decompose(allhc))
```


```{r}
library(forecast)
bestfit_allhc <- list(aicc=Inf)
for(i in 1:25)
{
  fit_allhc <- auto.arima(allhc, xreg=fourier(allhc, K=i), seasonal=FALSE)
  if(fit_allhc$aicc < bestfit_allhc$aicc)
    bestfit_allhc <- fit_allhc
  else break;
}
```


```{r}
summary(bestfit_allhc)
```


```{r}
fc_allhc <- forecast(bestfit_allhc, xreg=fourier(allhc, K=1, h=200))
plot(fc_allhc)
```


```{r}
summary(fc_allhc)
```

# FSHA ALLHC

```{r}
Allhc<-allhc[1:262]
P = abs(fft(Allhc)); Fr = 0:261
plot(Fr, P, type="o", xlab="frequency", ylab="periodogram",ylim=c(0,700))
```

```{r}
f<-abs(fft(Allhc))
a<-which(f>20)
b<-(a-1)*2
b
```

```{r}
t<-1:262
x=y=matrix(nr=length(t),nc=25)
x[,1]<-cos(2*pi*t/262)
y[,1]<-sin(2*pi*t/262)
x[,2]<-cos(4*pi*t/262)
y[,2]<-sin(4*pi*t/262)
x[,3]<-cos(6*pi*t/262)
y[,3]<-sin(6*pi*t/262)
x[,4]<-cos(8*pi*t/262)
y[,4]<-sin(8*pi*t/262)
x[,5]<-cos(12*pi*t/262)
y[,5]<-sin(12*pi*t/262)
mmm<-lm(Allhc~x[,1]+y[,1]+x[,2]+y[,2]+x[,3]+y[,3]+x[,4]+y[,4]+x[,5]+y[,5])
plot(Allhc,type="l")
lines(1:262,mmm$fitted.values,col="red")
abline(h=0)
```

# FOOD

```{r}
food <- ts(FOOD[,2], freq=365.25/7, start=2015+44/365.25)
plot(food)
```

```{r}
plot(decompose(food))
```

```{r}
bestfit_food <- list(aicc=Inf)
for(i in 1:25)
{
  fit_food <- auto.arima(food, xreg=fourier(food, K=i), seasonal=FALSE)
  if(fit_food$aicc < bestfit_food$aicc)
    bestfit_food <- fit_food
  else break;
}
```

```{r}
summary(bestfit_food)
```

```{r}
fc_food <- forecast(bestfit_food, xreg=fourier(food, K=1, h=200))
plot(fc_food)
```

```{r}
summary(fc_food)
```

# SMC

```{r}
smc <- ts(SMC[,2], freq=365.25/7, start=2015+44/365.25)
plot(smc)
```

```{r}
plot(decompose(smc))
```

```{r}
bestfit_smc <- list(aicc=Inf)
for(i in 1:25)
{
  fit_smc <- auto.arima(smc, xreg=fourier(smc, K=i), seasonal=FALSE)
  if(fit_smc$aicc < bestfit_smc$aicc)
    bestfit_smc <- fit_smc
  else break;
}
```

```{r}
summary(bestfit_smc)
```

```{r}
fc_smc <- forecast(bestfit_smc, xreg=fourier(smc, K=1, h=200))
plot(fc_smc)
```

```{r}
summary(fc_smc)
```

```{r}
fit_smc5 <- auto.arima(smc, xreg=fourier(smc, K=5), seasonal=FALSE)
```

```{r}
fc_smc5 <- forecast(fit_smc5, xreg=fourier(smc, K=5, h=200))
plot(fc_smc5)
```

```{r}
AIC(fit_smc5)
```

```{r}
plot(c(AIC(fit_smc),AIC(fit_smc2),AIC(fit_smc3),AIC(fit_smc4),AIC(fit_smc5),AIC(fit_smc6),AIC(fit_smc7),AIC(fit_smc8)))
```

